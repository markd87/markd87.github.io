<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" /><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Fake coins and infectious diseases | Mark Danovich</title>
<meta name="generator" content="Jekyll v4.0.1" />
<meta property="og:title" content="Fake coins and infectious diseases" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="How to speed up detection and testing using pooling" />
<meta property="og:description" content="How to speed up detection and testing using pooling" />
<meta property="og:site_name" content="Mark Danovich" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-05-08T00:00:00-05:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Fake coins and infectious diseases" />
<script type="application/ld+json">
{"headline":"Fake coins and infectious diseases","dateModified":"2020-05-08T00:00:00-05:00","description":"How to speed up detection and testing using pooling","datePublished":"2020-05-08T00:00:00-05:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"/2020/05/08/Fake-coins-and-infectious-diseases.html"},"url":"/2020/05/08/Fake-coins-and-infectious-diseases.html","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css" /><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="Mark Danovich" /><script async src="https://www.googletagmanager.com/gtag/js?id=UA-10819841-6"></script>
<script>
  window['ga-disable-UA-10819841-6'] = window.doNotTrack === "1" || navigator.doNotTrack === "1" || navigator.doNotTrack === "yes" || navigator.msDoNotTrack === "1";
  window.dataLayer = window.dataLayer || [];
  function gtag(){window.dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-10819841-6');
</script>
 




 
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">
<script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"> </script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"></script>
<script>
  document.addEventListener("DOMContentLoaded", function() {
    renderMathInElement( document.body, {
      delimiters: [
        {left: "$$", right: "$$", display: true},
        {left: "[%", right: "%]", display: true},
        {left: "$", right: "$", display: false}
      ]}
    );
  });
</script>


<script>
    function wrap_img(fn) {
        if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
            var elements = document.querySelectorAll(".post img");
            Array.prototype.forEach.call(elements, function (el, i) {
                if (el.getAttribute("title")) {
                    const caption = document.createElement('figcaption');
                    var node = document.createTextNode(el.getAttribute("title"));
                    caption.appendChild(node);
                    const wrapper = document.createElement('figure');
                    wrapper.className = 'image';
                    el.parentNode.insertBefore(wrapper, el);
                    el.parentNode.removeChild(el);
                    wrapper.appendChild(el);
                    wrapper.appendChild(caption);
                }
            });
        } else { document.addEventListener('DOMContentLoaded', fn); }
    }
    window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        // add link icon to anchor tags
        var elem = document.querySelectorAll(".anchor-link")
        elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script></head>
<body><header class="site-header">

    <div class="wrapper"><a class="site-title" rel="author" href="/">Mark Danovich</a><nav class="site-nav">
            <input type="checkbox" id="nav-trigger" class="nav-trigger" />
            <label for="nav-trigger">
                <span class="menu-icon">
                    <svg viewBox="0 0 18 15" width="18px" height="15px">
                        <path
                            d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z" />
                    </svg>
                </span>
            </label>

            <div class="trigger"><a class="page-link" href="/about/">About</a><a class="page-link" href="/snippets.html">Snippets</a></div>
        </nav></div>
</header><main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

    <header class="post-header">
        <h1 class="post-title p-name" itemprop="name headline">Fake coins and infectious diseases</h1><p class="page-description">How to speed up detection and testing using pooling</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2020-05-08T00:00:00-05:00" itemprop="datePublished">
                May 8, 2020
            </time>
        </p><p>
            
            
            <a class="category-tags-link" href="/tag/coding">
                coding
            </a>
            |
            
            
            <a class="category-tags-link" href="/tag/statistics">
                statistics
            </a>
            
            
        </p>

        

        
        
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
            <div class="px-2">
    
    <a href="https://github.com/markd87/markd87.github.io/tree/gh-pages/_notebooks/2020-05-08-Fake coins and infectious diseases.ipynb"
        role="button">
        <img class="notebook-badge-image" src="/assets/badges/github.svg"
                alt="View On GitHub">
        </a>
</div>
        </div>
        </header>

    <div class="post-content e-content" itemprop="articleBody">
        <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#Fake-coins">Fake coins </a></li>
<li class="toc-entry toc-h2"><a href="#Infectious-disease">Infectious disease </a></li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-05-08-Fake coins and infectious diseases.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="/images/copied_from_nb/../assets/coins.jpg" alt="image"></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Fake-coins">
<a class="anchor" href="#Fake-coins" aria-hidden="true"><span class="octicon octicon-link"></span></a>Fake coins<a class="anchor-link" href="#Fake-coins"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Imagine there are 1000 coins out of which 1% are fake, where a fake coin can weigh a little less or more than a real coin.
What is the fastest way to identify those 10 fake coins.</p>
<p>The slowest way would be to weigh each coin one-by-one, which will require 1000 weighings. Can we do better? Yes.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A better idea is known as pooling. Since we know only a small fraction of coins are fake, 
if we combine multiple coins into pools, some of these pools will contain only real coins allowing us 
to discard them, and remain with less coins to weigh.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The idea goes back to a <a href="https://projecteuclid.org/download/pdf_1/euclid.aoms/1177731363">paper</a> by Robert Dorfman published in 1943, where this method was applied to Syphilis antibody detection in blood tests, where multiple blood samples were pooled together and tested together.</p>
<p>Returning to the toy example of the coins, we divide the coins into pools of coins, and weigh each pool separately. Since we know the expected weight of a pool of real coins, we would know which pools contain fake coins, however we don't which are the individual fake coins yet.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>What is the advantage of pooling?</strong></p>
<p>The probability of any coin being fake is $r=0.01$ (the prevalence of fakes in the available coins).
Therefore, the probability of a pool of $s_1$ coins having at least one fake coin is:</p>
$$
p_1 = 1 - (1-r)^{s_1}.
$$<p>This is the complementary probability of all the coins being real, $(1-r)^{s_1}$.</p>
<p>If we divide the $N=1000$ coins into $N/s_1$ pools and weigh each pool, the expected number of pools that contain at least one fake coin is, $p_1\frac{N}{s_1}$. The power of the pooling technique is that $(1-p_1)\frac{N}{s_1}$ pools, will have all real coins, and therefore can be discarded.
The coins in the remainig suspicious pools can then be weighed individually. What is the total number of weighings we need to do?</p>
$$
T = N\left(\frac{1}{s_1} + p_1\right)
$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As an example, if we choose $s_1=20$, we have 50 initial pools of coins, out of which 41 pools will be discarded, and the expected number of weighings 
to be able to identify all fake coins is, $145$, a factor of ~7 improvement.
We see that the number of weighings or tests as a fraction of $N$ is independent of $N$.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>How to choose the optimal pool size?</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To get the optimal pool size, which will give the least amount of weighings, we need to minimize the expression for the number of tests $T$, by varying $s_1$.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">tests</span><span class="p">(</span><span class="n">pools</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">r</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
  <span class="sd">"""</span>
<span class="sd">  Calculate expected value of tests, as percentage of population</span>
<span class="sd">  """</span>
  <span class="k">def</span> <span class="nf">p_frac</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">r</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">"""</span>
<span class="sd">    helper function to Calculate p </span>
<span class="sd">    from prevelance r and pool size s</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">r</span><span class="p">)</span><span class="o">**</span><span class="n">s</span>

  <span class="n">r_val</span> <span class="o">=</span> <span class="n">r</span><span class="o">/</span><span class="mf">100.0</span>
  <span class="n">total_tests</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="n">r_vals</span> <span class="o">=</span> <span class="p">[</span><span class="n">r_val</span><span class="p">]</span>
  <span class="n">p_vals</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
  <span class="n">s_vals</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pools</span><span class="p">)):</span>
    <span class="n">s_vals</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">pools</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
    <span class="n">p_vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p_frac</span><span class="p">(</span><span class="n">s_vals</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">r_vals</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
    <span class="n">r_vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r_vals</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="n">p_vals</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">total_tests</span> <span class="o">+=</span> <span class="mi">1</span><span class="o">/</span><span class="n">s_vals</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">p_vals</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

  <span class="n">total_tests</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">p_vals</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">total_tests</span><span class="o">*</span><span class="mi">100</span>


<span class="k">def</span> <span class="nf">optim</span><span class="p">(</span><span class="n">n_pools</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">r</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">:</span>
  <span class="sd">"""</span>
<span class="sd">  Find optimal pool sizes for given number of poolings</span>
<span class="sd">  and prevalance r.</span>
<span class="sd">  parameters:</span>
<span class="sd">    - n_pools: number of pools</span>
<span class="sd">    - r: prevalance (percentage)</span>
<span class="sd">  returns:</span>
<span class="sd">    list of pool sizes and expected number of tests as </span>
<span class="sd">    percentage of population</span>
<span class="sd">  """</span>

  <span class="n">initial_pools</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_pools</span><span class="p">)]</span>
  <span class="n">initial_pools</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
  <span class="n">bounds</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5000</span><span class="p">)]</span><span class="o">*</span><span class="n">n_pools</span>

  <span class="n">res</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">tests</span><span class="p">,</span> 
                          <span class="n">initial_pools</span><span class="p">,</span>  
                          <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">,</span>
                          <span class="n">method</span><span class="o">=</span><span class="s1">'L-BFGS-B'</span><span class="p">,</span> 
                          <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s1">'maxiter'</span><span class="p">:</span><span class="mf">5e7</span><span class="p">},</span> 
                          <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">r</span><span class="p">),</span>
                          <span class="n">tol</span><span class="o">=</span><span class="mf">1e-15</span><span class="p">)</span>
  <span class="n">s</span><span class="o">=</span><span class="p">[]</span>
  <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">res</span><span class="o">.</span><span class="n">x</span><span class="p">:</span>
    <span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
  <span class="n">T</span> <span class="o">=</span> <span class="n">tests</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">s</span><span class="p">,</span> <span class="n">T</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Using the above optimization method for prevalence of $1\%$ gives:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Optimal pool size:  10
Number of weighings:  196
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A significant improvement over the original $1000$ weighings.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A natural extension is to continue the pooling, known as nested-pooling, i.e. we divide the pools following the first weighing to new pools, with a different pool size, which can again be determiend by minimizing the expression for the number of test, in this case of 2-pools given by a slightly more complex expression:</p>
$$
T = N\left(\frac{1}{s_1} + \frac{p_1}{s_2} + p_1p_2\right)
$$<p>where $s_1, s_2$ are the first and second pool sizes, respectively.
$p_1$ is as before, and $p_2 = 1 - (1-\frac{r}{p_1})^{s_2}$ is the modified probability for the second batch of pools.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>I've been using the word "expected" number of weighings because we are dealing with probabilities and randomness in the separation of the coins into pools, therefore we are dealing with a distribution of possible values, the expected value of which is given by
the formulas above. 
To demonstrate this we can actually run simulations of the pooling and record the number of required weighings.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">run_tests</span><span class="p">(</span><span class="n">S1</span><span class="p">:</span><span class="nb">int</span> <span class="o">=</span> <span class="mi">9</span><span class="p">,</span> <span class="n">S2</span><span class="p">:</span><span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">r</span><span class="p">:</span><span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">:</span><span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">"""</span>
<span class="sd">    Run pooling and testing simulation (up to 2 pools)</span>
<span class="sd">    retuns number of tests as fraction of population</span>
<span class="sd">    parameters:</span>
<span class="sd">        N - populationsize</span>
<span class="sd">        S - pool size</span>
<span class="sd">        r - prevalence (%)</span>
<span class="sd">    returns:</span>
<span class="sd">        tests as precentage of population</span>
<span class="sd">    """</span>
    <span class="n">pop</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">infected</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">choice</span><span class="p">(</span><span class="n">pop</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">r</span><span class="o">/</span><span class="mf">100.</span><span class="o">*</span><span class="n">N</span><span class="p">),</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span> 
    <span class="n">n_buckets</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">N</span><span class="o">/</span><span class="n">S1</span><span class="p">))</span>

    <span class="n">pop_perm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="n">pop</span><span class="p">)</span>
    <span class="n">buckets</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_split</span><span class="p">(</span><span class="n">pop_perm</span><span class="p">,</span> <span class="n">n_buckets</span><span class="p">)</span>
    
    <span class="n">positive_pop</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">bucket</span> <span class="ow">in</span> <span class="n">buckets</span><span class="p">:</span>
      <span class="k">if</span> <span class="ow">not</span> <span class="n">infected</span><span class="o">.</span><span class="n">isdisjoint</span><span class="p">(</span><span class="n">bucket</span><span class="p">):</span>
        <span class="n">positive_pop</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">bucket</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">S2</span><span class="p">:</span>
      <span class="c1"># second pool</span>
      <span class="n">n_buckets2</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">positive_pop</span><span class="p">)</span><span class="o">/</span><span class="n">S2</span><span class="p">))</span>
      <span class="n">positive_pop_perm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="n">positive_pop</span><span class="p">)</span>
      <span class="n">buckets2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_split</span><span class="p">(</span><span class="n">positive_pop_perm</span><span class="p">,</span> <span class="n">n_buckets2</span><span class="p">)</span>

      <span class="n">positive_pop2</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
      <span class="k">for</span> <span class="n">bucket</span> <span class="ow">in</span> <span class="n">buckets2</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">infected</span><span class="o">.</span><span class="n">isdisjoint</span><span class="p">(</span><span class="n">bucket</span><span class="p">):</span>
          <span class="n">positive_pop2</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">bucket</span><span class="p">)</span>

      <span class="n">total_tests</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">buckets</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">buckets2</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">positive_pop2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="c1"># Total number of test to get individual results</span>
      <span class="n">total_tests</span> <span class="o">=</span> <span class="n">n_buckets</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">positive_pop</span><span class="p">)</span>

    <span class="c1"># fraction of population tested </span>
    <span class="n">pop_frac</span> <span class="o">=</span> <span class="p">(</span><span class="n">total_tests</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="o">/</span><span class="n">N</span>
    <span class="k">return</span> <span class="n">pop_frac</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Running the tests multiple times for our example of the coins gives.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">N</span><span class="o">=</span><span class="mi">1000</span>
<span class="n">a</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5000</span><span class="p">):</span>
  <span class="n">a</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">run_tests</span><span class="p">(</span><span class="n">S1</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">1000</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Weighings = </span><span class="si">{</span><span class="n">N</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="mi">100</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2"> +- </span><span class="si">{</span><span class="n">N</span><span class="o">/</span><span class="mi">100</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Weighings = 196 +- 6
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can also simulate for different pool sizes and check if the above choice is indeed optimal.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">s</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>
<span class="n">means</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">s1</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
    <span class="n">a</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
        <span class="n">a</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">run_tests</span><span class="p">(</span><span class="n">S1</span><span class="o">=</span><span class="n">s1</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">1000</span><span class="p">))</span>
    <span class="n">means</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">N</span><span class="o">/</span><span class="mi">100</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>What about 2-pools? The above optimization method gives:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Optimal pools size:  [24  5]
Total number of weighings: 131
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A further reduction of 65 weighings.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note that pooling is most efficient when the prevelance is low, allowing to discard larger number of pools.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Infectious-disease">
<a class="anchor" href="#Infectious-disease" aria-hidden="true"><span class="octicon octicon-link"></span></a>Infectious disease<a class="anchor-link" href="#Infectious-disease"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This idea of pooling can be generalized to the case of detecting infected individuals in a susceptible population
for an infectious disease. The crucial difference is the "weighing" method, which in the case of detecting infected individuals, is the <a href="https://en.wikipedia.org/wiki/Real-time_polymerase_chain_reaction">qPCR</a> method, which is highly accurate way to identify the presence of a target DNA/RNA in a pooled sampled of DNAs.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>My friend Yossi Eliaz (<a href="https://twitter.com/yossieliaz">@YossiEliaz</a>) and I have explored this in a <a href="https://www.medrxiv.org/content/10.1101/2020.04.25.20079343v2">paper</a> we published in medRxiv
recently, demonstrating the great benefits of the pooling technique for testing for SARS-CoV-2 in a  population with an estimated prevalance obtained from a SIRD model fit to reported infections and deaths.
Alongside the paper we've also made a streamlit <a href="https://poolkeh.herokuapp.com/">app</a> allowing to find the optimal pooling strategy for different countries.</p>

</div>
</div>
</div>
</div>


    </div><a class="u-url" href="/2020/05/08/Fake-coins-and-infectious-diseases.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>My personal website and blog. Life, Science, Programming and Data Science.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/markd87" target="_blank" title="markd87"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/mmasaniad" target="_blank" title="mmasaniad"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
